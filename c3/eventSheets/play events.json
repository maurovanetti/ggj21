{
	"name": "Play Events",
	"events": [
		{
			"eventType": "include",
			"includeSheet": "Avatar Controls"
		},
		{
			"eventType": "include",
			"includeSheet": "Debug Events"
		},
		{
			"eventType": "variable",
			"name": "GAME_NAME",
			"type": "string",
			"initialValue": "patata-bollente",
			"comment": "",
			"isStatic": false,
			"isConstant": true,
			"sid": 340826543005715
		},
		{
			"eventType": "variable",
			"name": "INSTANCE_NAME",
			"type": "string",
			"initialValue": "default",
			"comment": "",
			"isStatic": false,
			"isConstant": true,
			"sid": 516413201601266
		},
		{
			"eventType": "variable",
			"name": "ROOM_NAME",
			"type": "string",
			"initialValue": "Arena",
			"comment": "",
			"isStatic": false,
			"isConstant": true,
			"sid": 472470540722491
		},
		{
			"eventType": "variable",
			"name": "GameState",
			"type": "string",
			"initialValue": "waiting",
			"comment": "waiting, playing",
			"isStatic": false,
			"isConstant": false,
			"sid": 836404875808987
		},
		{
			"functionName": "Log",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionIsAsync": false,
			"functionParameters": [
				{
					"name": "Message",
					"type": "string",
					"initialValue": "",
					"comment": "",
					"sid": 532112398378769
				}
			],
			"eventType": "function-block",
			"conditions": [],
			"actions": [],
			"sid": 367209875356039,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "is-running-typewriter-text",
							"objectClass": "Log",
							"sid": 635941720884454
						}
					],
					"actions": [
						{
							"id": "typewriter-finish",
							"objectClass": "Log",
							"sid": 355973479887117
						},
						{
							"id": "wait",
							"objectClass": "System",
							"sid": 484846944744615,
							"parameters": {
								"seconds": "0.2"
							}
						},
						{
							"id": "typewriter-text",
							"objectClass": "Log",
							"sid": 187376476564730,
							"parameters": {
								"text": "Message",
								"duration": "len(Message) * 0.03"
							}
						}
					],
					"sid": 990543629388286
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "else",
							"objectClass": "System",
							"sid": 994048450408205
						}
					],
					"actions": [
						{
							"id": "typewriter-text",
							"objectClass": "Log",
							"sid": 217967799145098,
							"parameters": {
								"text": "Message",
								"duration": "len(Message) * 0.02"
							}
						}
					],
					"sid": 972078213132226
				}
			]
		},
		{
			"functionName": "ConfigureParty",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionIsAsync": false,
			"functionParameters": [],
			"eventType": "function-block",
			"conditions": [],
			"actions": [
				{
					"id": "set-size",
					"objectClass": "PeerIDs",
					"sid": 142732122565884,
					"parameters": {
						"width": "Multiplayer.PeerCount",
						"height": "1",
						"depth": "1"
					}
				},
				{
					"id": "set-visible",
					"objectClass": "PlayerName",
					"sid": 212967293847692,
					"parameters": {
						"visibility": "visible"
					}
				}
			],
			"sid": 123413030223112,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "for",
							"objectClass": "System",
							"sid": 384767452637146,
							"parameters": {
								"name": "\"PeerIndex\"",
								"start-index": "0",
								"end-index": "Multiplayer.PeerCount"
							}
						}
					],
					"actions": [
						{
							"id": "set-at-x",
							"objectClass": "PeerIDs",
							"sid": 638164781011470,
							"parameters": {
								"x": "loopindex",
								"value": "Multiplayer.PeerIDAt(loopindex)"
							}
						}
					],
					"sid": 597870476109172
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-size",
							"objectClass": "PeerIDs",
							"sid": 543408802541148,
							"parameters": {
								"axis": "x",
								"comparison": 4,
								"value": "1"
							}
						}
					],
					"actions": [
						{
							"id": "sort",
							"objectClass": "PeerIDs",
							"sid": 397068954169879,
							"parameters": {
								"axis": "x"
							}
						},
						{
							"id": "set-enabled",
							"objectClass": "StartButton",
							"sid": 989646849613802,
							"parameters": {
								"mode": "enabled"
							}
						}
					],
					"sid": 783479301242920
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "else",
							"objectClass": "System",
							"sid": 945990012828369
						}
					],
					"actions": [
						{
							"id": "set-enabled",
							"objectClass": "StartButton",
							"sid": 700275866311509,
							"parameters": {
								"mode": "disabled"
							}
						}
					],
					"sid": 208920943328546
				},
				{
					"eventType": "block",
					"conditions": [],
					"actions": [
						{
							"id": "set-text",
							"objectClass": "PlayerName",
							"sid": 249484674731137,
							"parameters": {
								"text": "Multiplayer.PeerAliasFromID(PeerIDs.At(PlayerName.PlayerIndex))"
							}
						}
					],
					"sid": 511256304700301
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-instance-variable",
							"objectClass": "Avatar",
							"sid": 885888985479820,
							"parameters": {
								"instance-variable": "PlayerIndex",
								"comparison": 2,
								"value": "Multiplayer.PeerCount"
							}
						}
					],
					"actions": [
						{
							"id": "set-instvar-value",
							"objectClass": "Avatar",
							"sid": 361817418871790,
							"parameters": {
								"instance-variable": "PeerAlias",
								"value": "Multiplayer.PeerAliasFromID(PeerIDs.At(Avatar.PlayerIndex))"
							}
						},
						{
							"id": "set-instvar-value",
							"objectClass": "Avatar",
							"sid": 179009262139630,
							"parameters": {
								"instance-variable": "PeerID",
								"value": "PeerIDs.At(Avatar.PlayerIndex)"
							}
						}
					],
					"sid": 958740572055487
				}
			]
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Matchmaking",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-start-of-layout",
							"objectClass": "System",
							"sid": 613197220684519
						}
					],
					"actions": [
						{
							"callFunction": "Log",
							"sid": 307081757956390,
							"parameters": [
								"\"Connecting to signalling server…\""
							]
						},
						{
							"id": "sync-object",
							"objectClass": "Multiplayer",
							"sid": 409593476073186,
							"parameters": {
								"object": "Avatar",
								"data": "position-only",
								"precision": "normal-float-4-bytes",
								"bandwidth": "normal-bandwidth-unpredictable"
							}
						},
						{
							"id": "sync-instance-variable",
							"objectClass": "Multiplayer",
							"sid": 396131145436619,
							"parameters": {
								"object": "Avatar",
								"instance-variable": {
									"name": "Inputs",
									"objectClass": "Avatar"
								},
								"precision": "very-low-uint8-1-byte",
								"interpolation": "none",
								"client-value-tag": "\"inputs\""
							}
						},
						{
							"id": "add-client-input-value",
							"objectClass": "Multiplayer",
							"sid": 335349863696363,
							"parameters": {
								"tag": "\"inputs\"",
								"precision": "very-low-uint8-1-byte",
								"interpolation": "none"
							}
						},
						{
							"id": "connect",
							"objectClass": "Multiplayer",
							"sid": 133886881338203,
							"parameters": {
								"server": "\"wss://multiplayer.scirra.com\""
							}
						},
						{
							"id": "set-visible",
							"objectClass": "StartButton",
							"sid": 953984617826229,
							"parameters": {
								"visibility": "invisible"
							}
						},
						{
							"id": "set-visible",
							"objectClass": "PlayerName",
							"sid": 853072429970513,
							"parameters": {
								"visibility": "invisible"
							}
						}
					],
					"sid": 522667592383266
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-connected",
							"objectClass": "Multiplayer",
							"sid": 383121642175329
						}
					],
					"actions": [
						{
							"callFunction": "Log",
							"sid": 905315030154989,
							"parameters": [
								"\"Connected, logging in…\""
							]
						},
						{
							"id": "log-in",
							"objectClass": "Multiplayer",
							"sid": 496885709042530,
							"parameters": {
								"alias": "MyName"
							}
						}
					],
					"sid": 898576180263201
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-logged-in",
							"objectClass": "Multiplayer",
							"sid": 349451188546684
						}
					],
					"actions": [
						{
							"callFunction": "Log",
							"sid": 197786307906038,
							"parameters": [
								"\"Logged in as \" & Multiplayer.MyAlias & \" (ID: \" & Multiplayer.MyID & \"), joining room…\""
							]
						},
						{
							"id": "auto-join-room",
							"objectClass": "Multiplayer",
							"sid": 669977873157187,
							"parameters": {
								"game": "GAME_NAME",
								"instance": "INSTANCE_NAME",
								"first-room": "ROOM_NAME",
								"max-peers": "2",
								"locking": "lock-when-full"
							}
						}
					],
					"sid": 304826278553399
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-joined-room",
							"objectClass": "Multiplayer",
							"sid": 273458007816043
						}
					],
					"actions": [
						{
							"callFunction": "ConfigureParty",
							"sid": 982546591822082
						},
						{
							"id": "set-text",
							"objectClass": "RoomName",
							"sid": 910375915626053,
							"parameters": {
								"text": "Multiplayer.CurrentRoom"
							}
						}
					],
					"sid": 455367435737397,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "is-host",
									"objectClass": "Multiplayer",
									"sid": 287960382578929
								}
							],
							"actions": [
								{
									"callFunction": "Log",
									"sid": 822759953588992,
									"parameters": [
										"\"You are the game host\""
									]
								},
								{
									"id": "set-visible",
									"objectClass": "StartButton",
									"sid": 960875368797598,
									"parameters": {
										"visibility": "visible"
									}
								},
								{
									"id": "set-enabled",
									"objectClass": "StartButton",
									"sid": 267861296148179,
									"parameters": {
										"mode": "disabled"
									}
								},
								{
									"id": "set-group-active",
									"objectClass": "System",
									"sid": 887681603151421,
									"parameters": {
										"group-name": "\"Host\"",
										"state": "activated"
									}
								}
							],
							"sid": 365409939725310
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 416400790844953
								}
							],
							"actions": [
								{
									"callFunction": "Log",
									"sid": 859446761253261,
									"parameters": [
										"\"You are a game peer\""
									]
								},
								{
									"id": "destroy",
									"objectClass": "StartButton",
									"sid": 254704499026106
								},
								{
									"id": "destroy",
									"objectClass": "Avatar",
									"sid": 140614208373379
								},
								{
									"id": "set-group-active",
									"objectClass": "System",
									"sid": 860394973607216,
									"parameters": {
										"group-name": "\"Peer\"",
										"state": "activated"
									}
								}
							],
							"sid": 884284865114808
						}
					]
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-peer-connected",
							"objectClass": "Multiplayer",
							"sid": 182118815518661
						}
					],
					"actions": [
						{
							"callFunction": "ConfigureParty",
							"sid": 930180234809941
						}
					],
					"sid": 371309199144246
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-peer-disconnected",
							"objectClass": "Multiplayer",
							"sid": 718978317692982
						}
					],
					"actions": [
						{
							"callFunction": "ConfigureParty",
							"sid": 660504490829473
						}
					],
					"sid": 811821798161721
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-key-pressed",
							"objectClass": "Keyboard",
							"sid": 656524898802023,
							"parameters": {
								"key": 78
							}
						}
					],
					"actions": [
						{
							"id": "set-visible",
							"objectClass": "NetworkStats",
							"sid": 166522098809822,
							"parameters": {
								"visibility": "toggle"
							}
						}
					],
					"sid": 893200205548130
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "is-visible",
							"objectClass": "NetworkStats",
							"sid": 567491228608401
						}
					],
					"actions": [
						{
							"id": "set-text",
							"objectClass": "NetworkStats",
							"sid": 906167218743459,
							"parameters": {
								"text": "Multiplayer.StatInboundCount & \" in (\" & (round(Multiplayer.StatInboundBandwidth/100)/10) & \" k) / sec\" & newline & Multiplayer.StatOutboundCount & \" out (\" & (round(Multiplayer.StatOutboundBandwidth/100)/10) & \" k) / sec\" & newline & \"Host ping \" & round(Multiplayer.PeerLatency(Multiplayer.HostID)) & \", PDV \" & round(Multiplayer.PeerPDV(Multiplayer.HostID))"
							}
						}
					],
					"sid": 188794122019087
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-clicked",
							"objectClass": "StartButton",
							"sid": 521034732363413
						}
					],
					"actions": [
						{
							"id": "destroy",
							"objectClass": "StartButton",
							"sid": 526214499958077
						},
						{
							"id": "broadcast-message",
							"objectClass": "Multiplayer",
							"sid": 316205399465396,
							"parameters": {
								"from-id": "\"\"",
								"tag": "\"GameState change\"",
								"message": "\"playing\"",
								"mode": "reliable-unordered"
							}
						},
						{
							"id": "set-eventvar-value",
							"objectClass": "System",
							"sid": 442808617405746,
							"parameters": {
								"variable": "GameState",
								"value": "\"playing\""
							}
						}
					],
					"sid": 261006266300459,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-instance-variable",
									"objectClass": "Avatar",
									"sid": 844887811879300,
									"parameters": {
										"instance-variable": "PeerID",
										"comparison": 0,
										"value": "\"\""
									}
								}
							],
							"actions": [
								{
									"id": "destroy",
									"objectClass": "Avatar",
									"sid": 209353246434446
								}
							],
							"sid": 606726205206703
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 876478617655683
								}
							],
							"actions": [
								{
									"id": "associate-object-with-peer",
									"objectClass": "Multiplayer",
									"sid": 184688456306985,
									"parameters": {
										"object": "Avatar",
										"peer-id": "Avatar.PeerID"
									}
								}
							],
							"sid": 137620339943083
						}
					]
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-peer-message",
							"objectClass": "Multiplayer",
							"sid": 678493903694905,
							"parameters": {
								"tag": "\"GameState change\""
							}
						}
					],
					"actions": [
						{
							"id": "set-eventvar-value",
							"objectClass": "System",
							"sid": 978088143893041,
							"parameters": {
								"variable": "GameState",
								"value": "Multiplayer.Message"
							}
						}
					],
					"sid": 955338106732255
				}
			],
			"sid": 574492691276879
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Playing",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-eventvar",
							"objectClass": "System",
							"sid": 608645592195948,
							"parameters": {
								"variable": "GameState",
								"comparison": 0,
								"value": "\"playing\""
							}
						}
					],
					"actions": [
						{
							"callFunction": "CheckInputs",
							"sid": 210967493831757
						}
					],
					"sid": 652454315136357,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-instance-variable",
									"objectClass": "Avatar",
									"sid": 372850811457340,
									"parameters": {
										"instance-variable": "PeerID",
										"comparison": 0,
										"value": "Multiplayer.MyID"
									}
								}
							],
							"actions": [
								{
									"id": "set-instvar-value",
									"objectClass": "Avatar",
									"sid": 626780860978397,
									"parameters": {
										"instance-variable": "Inputs",
										"value": "Inputs"
									}
								}
							],
							"sid": 373482133769824
						},
						{
							"eventType": "group",
							"disabled": false,
							"title": "Host",
							"description": "",
							"isActiveOnStart": false,
							"children": [
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "for-each",
											"objectClass": "System",
											"sid": 156129139773509,
											"parameters": {
												"object": "Avatar"
											}
										}
									],
									"actions": [],
									"sid": 171587236052462,
									"children": [
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "compare-instance-variable",
													"objectClass": "Avatar",
													"sid": 748353705636830,
													"parameters": {
														"instance-variable": "PeerID",
														"comparison": 0,
														"value": "Multiplayer.MyID"
													},
													"isInverted": true
												}
											],
											"actions": [
												{
													"id": "set-instvar-value",
													"objectClass": "Avatar",
													"sid": 475244378284171,
													"parameters": {
														"instance-variable": "Inputs",
														"value": "Multiplayer.PeerState(Avatar.PeerID, \"inputs\")"
													}
												}
											],
											"sid": 157450475088155
										},
										{
											"eventType": "block",
											"conditions": [],
											"actions": [
												{
													"callFunction": "MoveAvatar",
													"sid": 904435967986062,
													"parameters": [
														"Avatar.UID"
													]
												}
											],
											"sid": 206464154055484
										}
									]
								}
							],
							"sid": 206193643965131
						},
						{
							"eventType": "group",
							"disabled": false,
							"title": "Peer",
							"description": "",
							"isActiveOnStart": false,
							"children": [
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "on-created",
											"objectClass": "Avatar",
											"sid": 722426129208237
										}
									],
									"actions": [
										{
											"id": "associate-object-with-peer",
											"objectClass": "Multiplayer",
											"sid": 163718678671912,
											"parameters": {
												"object": "Avatar",
												"peer-id": "Avatar.PeerID"
											}
										}
									],
									"sid": 220269866598697,
									"children": [
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "compare-instance-variable",
													"objectClass": "Avatar",
													"sid": 470525612422055,
													"parameters": {
														"instance-variable": "PeerID",
														"comparison": 0,
														"value": "Multiplayer.MyID"
													}
												}
											],
											"actions": [
												{
													"id": "enable-local-input-prediction",
													"objectClass": "Multiplayer",
													"sid": 122462553892126,
													"parameters": {
														"object": "Avatar"
													}
												}
											],
											"sid": 853240942740716
										}
									]
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "on-client-update",
											"objectClass": "Multiplayer",
											"sid": 530077013872376
										}
									],
									"actions": [
										{
											"id": "set-client-state",
											"objectClass": "Multiplayer",
											"sid": 235858298736451,
											"parameters": {
												"tag": "\"inputs\"",
												"value": "Inputs"
											}
										}
									],
									"sid": 154662192933705,
									"children": [
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "compare-instance-variable",
													"objectClass": "Avatar",
													"sid": 229929049896834,
													"parameters": {
														"instance-variable": "PeerID",
														"comparison": 0,
														"value": "Multiplayer.MyID"
													}
												}
											],
											"actions": [
												{
													"callFunction": "MoveAvatar",
													"sid": 761856886514263,
													"parameters": [
														"Avatar.UID"
													]
												}
											],
											"sid": 653452604765488
										}
									]
								}
							],
							"sid": 140951644177167
						}
					]
				}
			],
			"sid": 390860884619276
		}
	],
	"sid": 607373704127325
}