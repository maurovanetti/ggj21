{
	"name": "Play Events",
	"events": [
		{
			"eventType": "variable",
			"name": "GAME_NAME",
			"type": "string",
			"initialValue": "patata-bollente",
			"comment": "",
			"isStatic": false,
			"isConstant": true,
			"sid": 340826543005715
		},
		{
			"eventType": "variable",
			"name": "INSTANCE_NAME",
			"type": "string",
			"initialValue": "default",
			"comment": "",
			"isStatic": false,
			"isConstant": true,
			"sid": 516413201601266
		},
		{
			"eventType": "variable",
			"name": "ROOM_NAME",
			"type": "string",
			"initialValue": "Arena",
			"comment": "",
			"isStatic": false,
			"isConstant": true,
			"sid": 472470540722491
		},
		{
			"eventType": "variable",
			"name": "GameState",
			"type": "string",
			"initialValue": "waiting",
			"comment": "waiting, playing",
			"isStatic": false,
			"isConstant": false,
			"sid": 836404875808987
		},
		{
			"functionName": "Log",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionIsAsync": false,
			"functionParameters": [
				{
					"name": "Message",
					"type": "string",
					"initialValue": "",
					"comment": "",
					"sid": 532112398378769
				}
			],
			"eventType": "function-block",
			"conditions": [],
			"actions": [],
			"sid": 367209875356039,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "is-running-typewriter-text",
							"objectClass": "Log",
							"sid": 635941720884454
						}
					],
					"actions": [
						{
							"id": "typewriter-finish",
							"objectClass": "Log",
							"sid": 355973479887117
						},
						{
							"id": "wait",
							"objectClass": "System",
							"sid": 484846944744615,
							"parameters": {
								"seconds": "0.2"
							}
						},
						{
							"id": "typewriter-text",
							"objectClass": "Log",
							"sid": 187376476564730,
							"parameters": {
								"text": "Message",
								"duration": "len(Message) * 0.03"
							}
						}
					],
					"sid": 990543629388286
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "else",
							"objectClass": "System",
							"sid": 994048450408205
						}
					],
					"actions": [
						{
							"id": "typewriter-text",
							"objectClass": "Log",
							"sid": 217967799145098,
							"parameters": {
								"text": "Message",
								"duration": "len(Message) * 0.02"
							}
						}
					],
					"sid": 972078213132226
				}
			]
		},
		{
			"functionName": "ConfigureParty",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionIsAsync": false,
			"functionParameters": [],
			"eventType": "function-block",
			"conditions": [],
			"actions": [
				{
					"id": "set-size",
					"objectClass": "PeerIDs",
					"sid": 142732122565884,
					"parameters": {
						"width": "Multiplayer.PeerCount",
						"height": "1",
						"depth": "1"
					}
				},
				{
					"id": "set-visible",
					"objectClass": "PlayerName",
					"sid": 212967293847692,
					"parameters": {
						"visibility": "visible"
					}
				}
			],
			"sid": 123413030223112,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "for",
							"objectClass": "System",
							"sid": 384767452637146,
							"parameters": {
								"name": "\"PeerIndex\"",
								"start-index": "0",
								"end-index": "Multiplayer.PeerCount"
							}
						}
					],
					"actions": [
						{
							"id": "set-at-x",
							"objectClass": "PeerIDs",
							"sid": 638164781011470,
							"parameters": {
								"x": "loopindex",
								"value": "Multiplayer.PeerIDAt(loopindex)"
							}
						}
					],
					"sid": 597870476109172
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-size",
							"objectClass": "PeerIDs",
							"sid": 543408802541148,
							"parameters": {
								"axis": "x",
								"comparison": 4,
								"value": "1"
							}
						}
					],
					"actions": [
						{
							"id": "sort",
							"objectClass": "PeerIDs",
							"sid": 397068954169879,
							"parameters": {
								"axis": "x"
							}
						},
						{
							"id": "set-enabled",
							"objectClass": "StartButton",
							"sid": 989646849613802,
							"parameters": {
								"mode": "enabled"
							}
						}
					],
					"sid": 783479301242920
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "else",
							"objectClass": "System",
							"sid": 945990012828369
						}
					],
					"actions": [
						{
							"id": "set-enabled",
							"objectClass": "StartButton",
							"sid": 466521172560120,
							"parameters": {
								"mode": "disabled"
							}
						}
					],
					"sid": 208920943328546
				},
				{
					"eventType": "block",
					"conditions": [],
					"actions": [
						{
							"id": "set-text",
							"objectClass": "PlayerName",
							"sid": 249484674731137,
							"parameters": {
								"text": "Multiplayer.PeerAliasFromID(PeerIDs.At(PlayerName.PlayerIndex))"
							}
						}
					],
					"sid": 511256304700301
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-instance-variable",
							"objectClass": "Avatar",
							"sid": 885888985479820,
							"parameters": {
								"instance-variable": "PlayerIndex",
								"comparison": 2,
								"value": "Multiplayer.PeerCount"
							}
						}
					],
					"actions": [
						{
							"id": "set-instvar-value",
							"objectClass": "Avatar",
							"sid": 361817418871790,
							"parameters": {
								"instance-variable": "PeerAlias",
								"value": "Multiplayer.PeerAliasFromID(PeerIDs.At(Avatar.PlayerIndex))"
							}
						},
						{
							"id": "set-instvar-value",
							"objectClass": "Avatar",
							"sid": 179009262139630,
							"parameters": {
								"instance-variable": "PeerID",
								"value": "PeerIDs.At(Avatar.PlayerIndex)"
							}
						}
					],
					"sid": 958740572055487
				}
			]
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Matchmaking",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-start-of-layout",
							"objectClass": "System",
							"sid": 613197220684519
						}
					],
					"actions": [
						{
							"callFunction": "Log",
							"sid": 307081757956390,
							"parameters": [
								"\"Connecting to signalling server…\""
							]
						},
						{
							"id": "sync-object",
							"objectClass": "Multiplayer",
							"sid": 409593476073186,
							"parameters": {
								"object": "Avatar",
								"data": "position-only",
								"precision": "normal-float-4-bytes",
								"bandwidth": "normal-bandwidth-unpredictable"
							}
						},
						{
							"id": "connect",
							"objectClass": "Multiplayer",
							"sid": 133886881338203,
							"parameters": {
								"server": "\"wss://multiplayer.scirra.com\""
							}
						},
						{
							"id": "set-visible",
							"objectClass": "StartButton",
							"sid": 953984617826229,
							"parameters": {
								"visibility": "invisible"
							}
						},
						{
							"id": "set-visible",
							"objectClass": "PlayerName",
							"sid": 853072429970513,
							"parameters": {
								"visibility": "invisible"
							}
						}
					],
					"sid": 522667592383266
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-connected",
							"objectClass": "Multiplayer",
							"sid": 383121642175329
						}
					],
					"actions": [
						{
							"callFunction": "Log",
							"sid": 905315030154989,
							"parameters": [
								"\"Connected, logging in…\""
							]
						},
						{
							"id": "log-in",
							"objectClass": "Multiplayer",
							"sid": 496885709042530,
							"parameters": {
								"alias": "MyName"
							}
						}
					],
					"sid": 898576180263201
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-logged-in",
							"objectClass": "Multiplayer",
							"sid": 349451188546684
						}
					],
					"actions": [
						{
							"callFunction": "Log",
							"sid": 197786307906038,
							"parameters": [
								"\"Logged in as \" & Multiplayer.MyAlias & \" (ID: \" & Multiplayer.MyID & \"), joining room…\""
							]
						},
						{
							"id": "auto-join-room",
							"objectClass": "Multiplayer",
							"sid": 669977873157187,
							"parameters": {
								"game": "GAME_NAME",
								"instance": "INSTANCE_NAME",
								"first-room": "ROOM_NAME",
								"max-peers": "2",
								"locking": "lock-when-full"
							}
						}
					],
					"sid": 304826278553399
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-joined-room",
							"objectClass": "Multiplayer",
							"sid": 273458007816043
						}
					],
					"actions": [
						{
							"callFunction": "ConfigureParty",
							"sid": 982546591822082
						},
						{
							"id": "set-text",
							"objectClass": "RoomName",
							"sid": 910375915626053,
							"parameters": {
								"text": "Multiplayer.CurrentRoom"
							}
						}
					],
					"sid": 455367435737397,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "is-host",
									"objectClass": "Multiplayer",
									"sid": 287960382578929
								}
							],
							"actions": [
								{
									"callFunction": "Log",
									"sid": 822759953588992,
									"parameters": [
										"\"You are the game host\""
									]
								},
								{
									"id": "set-visible",
									"objectClass": "StartButton",
									"sid": 960875368797598,
									"parameters": {
										"visibility": "visible"
									}
								},
								{
									"id": "set-enabled",
									"objectClass": "StartButton",
									"sid": 267861296148179,
									"parameters": {
										"mode": "disabled"
									}
								},
								{
									"id": "set-group-active",
									"objectClass": "System",
									"sid": 887681603151421,
									"parameters": {
										"group-name": "\"Host\"",
										"state": "activated"
									}
								}
							],
							"sid": 365409939725310
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 416400790844953
								}
							],
							"actions": [
								{
									"callFunction": "Log",
									"sid": 859446761253261,
									"parameters": [
										"\"You are a game peer\""
									]
								},
								{
									"id": "destroy",
									"objectClass": "StartButton",
									"sid": 254704499026106
								},
								{
									"id": "destroy",
									"objectClass": "Avatar",
									"sid": 140614208373379
								},
								{
									"id": "set-group-active",
									"objectClass": "System",
									"sid": 860394973607216,
									"parameters": {
										"group-name": "\"Peer\"",
										"state": "activated"
									}
								}
							],
							"sid": 884284865114808
						}
					]
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-peer-connected",
							"objectClass": "Multiplayer",
							"sid": 182118815518661
						}
					],
					"actions": [
						{
							"callFunction": "ConfigureParty",
							"sid": 930180234809941
						}
					],
					"sid": 371309199144246
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-peer-disconnected",
							"objectClass": "Multiplayer",
							"sid": 718978317692982
						}
					],
					"actions": [
						{
							"callFunction": "ConfigureParty",
							"sid": 660504490829473
						}
					],
					"sid": 811821798161721
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-key-pressed",
							"objectClass": "Keyboard",
							"sid": 656524898802023,
							"parameters": {
								"key": 78
							}
						}
					],
					"actions": [
						{
							"id": "set-visible",
							"objectClass": "NetworkStats",
							"sid": 166522098809822,
							"parameters": {
								"visibility": "toggle"
							}
						}
					],
					"sid": 893200205548130
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "is-visible",
							"objectClass": "NetworkStats",
							"sid": 567491228608401
						}
					],
					"actions": [
						{
							"id": "set-text",
							"objectClass": "NetworkStats",
							"sid": 906167218743459,
							"parameters": {
								"text": "Multiplayer.StatInboundCount & \" in (\" & (round(Multiplayer.StatInboundBandwidth/100)/10) & \" k) / sec\" & newline & Multiplayer.StatOutboundCount & \" out (\" & (round(Multiplayer.StatOutboundBandwidth/100)/10) & \" k) / sec\" & newline & \"Host ping \" & round(Multiplayer.PeerLatency(Multiplayer.HostID)) & \", PDV \" & round(Multiplayer.PeerPDV(Multiplayer.HostID))"
							}
						}
					],
					"sid": 188794122019087
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-clicked",
							"objectClass": "StartButton",
							"sid": 521034732363413
						}
					],
					"actions": [
						{
							"id": "destroy",
							"objectClass": "StartButton",
							"sid": 526214499958077
						},
						{
							"id": "broadcast-message",
							"objectClass": "Multiplayer",
							"sid": 316205399465396,
							"parameters": {
								"from-id": "\"\"",
								"tag": "\"GameState change\"",
								"message": "\"playing\"",
								"mode": "reliable-unordered"
							}
						},
						{
							"id": "set-eventvar-value",
							"objectClass": "System",
							"sid": 442808617405746,
							"parameters": {
								"variable": "GameState",
								"value": "\"playing\""
							}
						},
						{
							"id": "associate-object-with-peer",
							"objectClass": "Multiplayer",
							"sid": 268971569951334,
							"parameters": {
								"object": "Avatar",
								"peer-id": "Avatar.PeerID"
							}
						}
					],
					"sid": 261006266300459
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-peer-message",
							"objectClass": "Multiplayer",
							"sid": 678493903694905,
							"parameters": {
								"tag": "\"GameState change\""
							}
						}
					],
					"actions": [
						{
							"id": "set-eventvar-value",
							"objectClass": "System",
							"sid": 978088143893041,
							"parameters": {
								"variable": "GameState",
								"value": "Multiplayer.Message"
							}
						}
					],
					"sid": 955338106732255
				}
			],
			"sid": 574492691276879
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "compare-eventvar",
					"objectClass": "System",
					"sid": 168031450548852,
					"parameters": {
						"variable": "GameState",
						"comparison": 0,
						"value": "\"playing\""
					}
				}
			],
			"actions": [],
			"sid": 354888765212396,
			"children": [
				{
					"eventType": "group",
					"disabled": false,
					"title": "Host",
					"description": "",
					"isActiveOnStart": false,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "is-enabled",
									"objectClass": "Avatar0",
									"sid": 912362839413622,
									"behaviorType": "8Direction",
									"isInverted": true
								}
							],
							"actions": [
								{
									"id": "set-enabled",
									"objectClass": "Avatar0",
									"sid": 550475268867509,
									"behaviorType": "8Direction",
									"parameters": {
										"state": "enabled"
									}
								}
							],
							"sid": 707289090153605
						}
					],
					"sid": 140072129924469
				},
				{
					"eventType": "group",
					"disabled": false,
					"title": "Peer",
					"description": "",
					"isActiveOnStart": false,
					"children": [],
					"sid": 607145855502864
				}
			]
		}
	],
	"sid": 607373704127325
}